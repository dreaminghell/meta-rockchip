From 77743a604bf6402a61c1df724e94e6340f514e79 Mon Sep 17 00:00:00 2001
From: Daniel Stone <daniels@collabora.com>
Date: Tue, 28 Feb 2017 17:43:55 +0000
Subject: [PATCH 29/94] Change repaint_needed to bool

It is only used as a binary value.

Signed-off-by: Daniel Stone <daniels@collabora.com>
---
 src/compositor-drm.c   | 2 +-
 src/compositor-fbdev.c | 2 +-
 src/compositor.c       | 4 ++--
 src/compositor.h       | 5 ++++-
 4 files changed, 8 insertions(+), 5 deletions(-)

diff --git a/src/compositor-drm.c b/src/compositor-drm.c
index 31e0ef1..3ac3552 100644
--- a/src/compositor-drm.c
+++ b/src/compositor-drm.c
@@ -2830,7 +2830,7 @@ session_notify(struct wl_listener *listener, void *data)
 		 * pending frame callbacks. */
 
 		wl_list_for_each(output, &compositor->output_list, base.link) {
-			output->base.repaint_needed = 0;
+			output->base.repaint_needed = false;
 			drmModeSetCursor(b->drm.fd, output->crtc_id, 0, 0, 0);
 		}
 
diff --git a/src/compositor-fbdev.c b/src/compositor-fbdev.c
index ee762e3..f7b939a 100644
--- a/src/compositor-fbdev.c
+++ b/src/compositor-fbdev.c
@@ -717,7 +717,7 @@ session_notify(struct wl_listener *listener, void *data)
 
 		wl_list_for_each(output,
 				 &compositor->output_list, link) {
-			output->repaint_needed = 0;
+			output->repaint_needed = false;
 		}
 	}
 }
diff --git a/src/compositor.c b/src/compositor.c
index 1afd0a5..8dc2144 100644
--- a/src/compositor.c
+++ b/src/compositor.c
@@ -2395,7 +2395,7 @@ weston_output_repaint(struct weston_output *output)
 
 	pixman_region32_fini(&output_damage);
 
-	output->repaint_needed = 0;
+	output->repaint_needed = false;
 
 	weston_compositor_repick(ec);
 
@@ -2571,7 +2571,7 @@ weston_output_schedule_repaint(struct weston_output *output)
 		TL_POINT("core_repaint_req", TLP_OUTPUT(output), TLP_END);
 
 	loop = wl_display_get_event_loop(compositor->wl_display);
-	output->repaint_needed = 1;
+	output->repaint_needed = true;
 	if (output->repaint_scheduled)
 		return;
 
diff --git a/src/compositor.h b/src/compositor.h
index 0bbf458..4d8605c 100644
--- a/src/compositor.h
+++ b/src/compositor.h
@@ -190,7 +190,10 @@ struct weston_output {
 	pixman_region32_t region;
 
 	pixman_region32_t previous_damage;
-	int repaint_needed;
+
+	/** True if damage has occurred since the last repaint for this output;
+	 *  if set, a repaint will eventually occur. */
+	bool repaint_needed;
 	int repaint_scheduled;
 	struct wl_event_source *repaint_timer;
 	struct weston_output_zoom zoom;
-- 
1.9.1

